// Ion.Sound | version 2.1.5 | https://github.com/IonDen/ion.sound
var ion=ion||{};(function(e){var t=function(e){if(e&&console){if(console.warn&&typeof console.warn==="function"){console.warn(e)}else if(console.log&&typeof console.log==="function"){console.log(e)}}};if(e.sound){t("ion.sound already exists!");return}if(typeof Audio!=="function"&&typeof Audio!=="object"){var n=function(){t("HTML5 Audio is not supported in this browser")};e.sound=function(){};e.sound.play=n;e.sound.stop=n;e.sound.destroy=n;n();return}var r,i=/iPad|iPhone/.test(navigator.appVersion),s,o={},u={},a,f,l;if(i){r=function(e){this.name=e.name;this.filename=e.fileName;this.loop=false;this.paused=false;this.sound=null;this.callback=null};r.prototype={init:function(){this.sound=s},play:function(e){if(!e){e={}}if(e.loop){if(this.paused){this._playLoop(this.loop+1)}else{this._playLoop(e.loop)}}else{this.loop=false;this._play()}if(e.onEnded&&typeof e.onEnded==="function"){this.callback=e.onEnded}},_play:function(){if(this.paused){this.paused=false}else{try{this.sound.currentTime=0}catch(e){}}this.sound.removeEventListener("ended");this.sound.addEventListener("ended",this._ended.bind(this),false);this.sound.src=this.path+this.fileName+f;this.sound.load();this.sound.play()}}}else{r=function(e){this.name=e.name;this.volume=o.volume||.5;this.preload=o.preload?"auto":"none";this.loop=false;this.paused=false;this.sound=null;this.callback=null;this.path=e.path===undefined?o.path:e.path||"";this.fileName=e.name;if("volume"in e){this.volume=+e.volume}if("preload"in e){this.preload=e.preload?"auto":"none"}if("fileName"in e){this.fileName=e.fileName===""?e.name:e.fileName}};r.prototype={init:function(){this.sound=new Audio;this.sound.src=this.path+this.fileName+f;this.sound.load();this.sound.preload=this.preload;this.sound.volume=this.volume;this.sound.addEventListener("ended",this._ended.bind(this),false)},play:function(e){if(!e){e={}}if(e.volume||e.volume===0){this.volume=+e.volume;this.sound.volume=this.volume}if(e.loop){if(this.paused){this._playLoop(this.loop+1)}else{this._playLoop(e.loop)}}else{this.loop=false;this._play()}if(e.onEnded&&typeof e.onEnded==="function"){this.callback=e.onEnded}},_play:function(){if(this.paused){this.paused=false}else{try{this.sound.currentTime=0}catch(e){}}this.sound.load();this.sound.play()}}}r.prototype._playLoop=function(e){if(typeof e==="boolean"){this.loop=9999999;this._play()}else if(typeof e==="number"){this.loop=e-1;this._play()}};r.prototype._ended=function(){if(this.loop>0){this.loop-=1;this._play()}if(this.callback){this.callback(this.name)}};r.prototype.pause=function(){this.paused=true;this.sound.pause()};r.prototype.stop=function(){this.loop=false;this.sound.pause();try{this.sound.currentTime=0}catch(e){}};r.prototype.destroy=function(){this.stop();this.sound.removeEventListener("ended",this._ended.bind(this),false);this.sound.src="";this.sound=null};var c=function(){s=new Audio;var e=s.canPlayType("audio/mpeg"),t=s.canPlayType("audio/ogg"),n=s.canPlayType('audio/mp4; codecs="mp4a.40.2"');if(i){if(e==="probably"){f=".mp3"}else if(n==="probably"){f=".aac"}else if(e==="maybe"){f=".mp3"}else if(n==="maybe"){f=".aac"}}else{if(e==="probably"){f=".mp3"}else if(t==="probably"){f=".ogg"}else if(e==="maybe"){f=".mp3"}else if(t==="maybe"){f=".ogg"}else{f=".wav"}}};var h=function(e){u[e.name]=new r(e);u[e.name].init()};e.sound=function(e){o=JSON.parse(JSON.stringify(e));o.path=o.path||"";o.volume=o.volume||.5;o.preload=o.preload||false;o.mix=o.mix||true;a=o.sounds.length;if(!a){t("No sound-files provided!");return}c();for(l=0;l<a;l++){h(o.sounds[l])}};e.sound.version="2.1.3";e.sound.play=function(e,t){if(u[e]){u[e].play(t)}};e.sound.pause=function(e){if(e&&u[e]){u[e].pause()}else{for(l in u){if(!u.hasOwnProperty(l)){continue}if(u[l]){u[l].pause()}}}};e.sound.stop=function(e){if(e&&u[e]){u[e].stop()}else{for(l in u){if(!u.hasOwnProperty(l)){continue}if(u[l]){u[l].stop()}}}};e.sound.destroy=function(e){if(e&&u[e]){u[e].destroy();u[e]=null}else{for(l in u){if(!u.hasOwnProperty(l)){continue}if(u[l]){u[l].destroy();u[l]=null}}}}})(ion)
